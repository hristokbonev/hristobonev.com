{% extends "base.html" %}
{% block title %}Contact{% endblock %}
{% block head %}
    <script src="https://www.google.com/recaptcha/enterprise.js?render=6Lf5a48qAAAAAAFQJxwv0UKOokY2VEWRIBmQ-s1A"></script>
{% endblock %}
{% block content %}
<main class="contact-main">
    <div class="contact-container">
        <h1 class="contact-title">Contact Me</h1>
        <form action="/contact/" method="post" class="contact-form">
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="message">Message</label>
                <textarea id="message" name="message" rows="5" required></textarea>
            </div>

            <div class="g-recaptcha" 
         data-sitekey= "6Lf5a48qAAAAAAFQJxwv0UKOokY2VEWRIBmQ-s1A"
         data-callback="onSubmit"
         data-action="submit">
            </div>

            <button type="submit">Send Message</button>

        </form>
        <br>
        <p>You can also reach me at <span id="email-link"></span></p>
    </div>    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const email = "chkbonev" + "@gmail.com";
            const emailLink = `<a href="mailto:${email}">email</a>`;
            document.getElementById("email-link").innerHTML = emailLink;
        });

        function onSubmit(token) {
        // Add the reCAPTCHA token as a hidden input field to the form
        const recaptchaInput = document.createElement("input");
        recaptchaInput.type = "hidden";
        recaptchaInput.name = "recaptcha_token";  // This should match your backend handler
        recaptchaInput.value = token;
        document.querySelector(".contact-form").appendChild(recaptchaInput);
        
        // Submit the form after adding the token
        document.querySelector(".contact-form").submit();
    }
    </script>
</main>
{% endblock %}